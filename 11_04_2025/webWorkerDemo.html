<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  </head>
  <body>
    when you start normal loop it run on the sigle thread and block the UI, so
    you can't click on the buttons until the loop is finished.
    <br />
    when you start the loop on web worker, it will run on a different thread and
    you can click on the buttons while the loop is running.

    <br />
    <br />
    <br />
    <br />
    <br />
    <button onclick="startHeavyLoop()">begin heavy loop</button>
    <button onclick="startHeavyLoopOnWebWorker('start')">
      begin heavy loop on web worker
    </button>
    <button onclick="startHeavyLoopOnWebWorker('stop')">
      stop heavy loop on web worker
    </button>
    <button onclick="changeBackgroundColor()">change background color</button>
    <button onclick="removeBackgroundColor()">remove background color</button>
    <button onclick="alert('hello')">alert</button>

    <p id="Message"></p>

    <script>
      function removeBackgroundColor() {
        document.body.style.backgroundColor = "white";
        document.getElementById("Message").style.color = "black";
        document.getElementById("Message").innerHTML =
          "Background color removed.";
      }

      function startHeavyLoop() {
        let i = 0;
        while (i < 1000000) {
          i++;
          document.getElementById("Message").innerHTML = i;
        }
      }

      function changeBackgroundColor() {
        document.body.style.backgroundColor = "blue";
        document.getElementById("Message").style.color = "white";
        document.getElementById("Message").innerHTML =
          "Background color changed to blue.";
      }

      function startHeavyLoopOnWebWorker(task) {
        let worker = null;
        if (task === "start") {
          worker = new Worker("worker.js");
          worker.postMessage("start");
          worker.onmessage = function (event) {
            console.log("Message from worker: ", event.data);
            document.getElementById("Message").innerHTML = event.data;
          };
        } else if (task === "stop" && worker) {
          worker.terminate();
          document.getElementById("Message").innerHTML = "Worker terminated.";
          worker = null; 
          return;
        }
      }
    </script>
  </body>
</html>
